üîç AN√ÅLISE COMPLETA DE INCONSIST√äNCIAS DO SCHEMA - DBA MASTER REPORT
üìä RESUMO EXECUTIVO
Total de Tabelas Analisadas: 107 tabelas
Inconsist√™ncias Identificadas: 47 problemas cr√≠ticos e m√©dios
Status Geral: ‚ö†Ô∏è REQUER ATEN√á√ÉO IMEDIATA

üö® INCONSIST√äNCIAS CR√çTICAS (Prioridade 1)
1. FOREIGN KEYS - INCOMPATIBILIDADE DE TIPOS
-- PROBLEMA: users.id como VARCHAR referenciado como UUID
-- TABELAS AFETADAS: 23 tabelas com FK para users
STATUS: ‚úÖ RESOLVIDO (users.id convertido para UUID)
2. NOMENCLATURA - PADR√ïES INCONSISTENTES
// FAVORECIDOS vs CUSTOMERS - Padr√µes diferentes
favorecidos: {
  name: varchar("name", { length: 255 })  // Campo √∫nico
}
customers: {
  firstName: varchar("first_name", { length: 255 }),
  lastName: varchar("last_name", { length: 255 })  // Campos separados
}
3. CAMPOS DE AUDITORIA - IMPLEMENTA√á√ÉO PARCIAL
Tabelas SEM auditoria completa: 12 de 107 tabelas

// FALTANDO em algumas tabelas:
- createdAt: timestamp("created_at").defaultNow()
- updatedAt: timestamp("updated_at").defaultNow()  
- isActive: boolean("is_active").default(true)
‚ö†Ô∏è INCONSIST√äNCIAS M√âDIAS (Prioridade 2)
4. STATUS DEFAULTS - VALORES DIFERENTES
tickets.status: .default("open")          // Helpdesk workflow
projects.status: .default("planning")     // PM workflow  
projectActions.status: .default("pending") // Task workflow
5. TELEFONE - REDUND√ÇNCIA CONFUSA
favorecidos: {
  phone: varchar("phone", { length: 20 }),
  cellPhone: varchar("cell_phone", { length: 20 }) // Prop√≥sitos n√£o claros
}
6. CAMPOS BRASILEIROS vs INGL√äS
favorecidos: {
  cpf: varchar("cpf", { length: 14 }),     // Portugu√™s (legal)
  email: varchar("email", { length: 255 }) // Ingl√™s (internacional)
}
üîß PROBLEMAS DE ESTRUTURA
7. √çNDICES - OTIMIZA√á√ÉO TENANT-FIRST INCOMPLETA
Problemas identificados:

15 tabelas sem √≠ndices tenant-first otimizados
Queries de geolocaliza√ß√£o sem √≠ndices espaciais
Relacionamentos FK sem √≠ndices de performance
8. CONSTRAINTS - ISOLAMENTO TENANT INCONSISTENTE
-- ALGUNS t√™m:
UNIQUE(tenant_id, email)
-- OUTROS n√£o t√™m isolamento adequado:
UNIQUE(email) -- ‚ùå Permite duplicatas entre tenants
9. ARRAYS vs JSONB - IMPLEMENTA√á√ÉO MISTA
// NATIVO (otimizado):
tags: text("tags").array()
// JSONB (menos otimizado para arrays simples):
someField: jsonb("some_field") // Para arrays simples
üìã VALIDA√á√ÉO E COMPLIANCE
10. TABELAS N√ÉO VALIDADAS
Schema define: 107 tabelas
Valida√ß√£o cobre: 59 tabelas
GAP: 48 tabelas sem valida√ß√£o

11. CLT COMPLIANCE - CAMPOS OBRIGAT√ìRIOS
// FALTANDO em algumas tabelas de timecard:
nsr: bigint("nsr", { mode: "number" }).notNull()
recordHash: varchar("record_hash", { length: 64 }).notNull()
digitalSignature: text("digital_signature")
üèóÔ∏è PROBLEMAS ARQUITETURAIS
12. SCHEMAS DUPLICADOS
schema-master.ts (principal)
schema-materials-services.ts (m√≥dulo)
schema-locations.ts (geolocaliza√ß√£o)
RISCO: Defini√ß√µes conflitantes
13. RELACIONAMENTOS √ìRF√ÉOS
// FKs sem constraints definidas:
customerCompanyId: uuid("customer_company_id") // Sem .references()
beneficiaryId: uuid("beneficiary_id")          // Sem .references()
14. TIPOS DE DADOS INCONSISTENTES
// Telefones com tamanhos diferentes:
phone: varchar("phone", { length: 20 })  // Em algumas tabelas
phone: varchar("phone", { length: 50 })  // Em outras tabelas
üì± PROBLEMAS DE M√ìDULOS ESPEC√çFICOS
15. MATERIALS-SERVICES - DUPLICA√á√ÉO
Tabelas items definidas em 2 lugares diferentes
Campos conflitantes entre defini√ß√µes
16. TICKETS - METADADOS HARD-CODED
Prioridades e status fixos no c√≥digo
Falta sistema hier√°rquico de configura√ß√£o
17. LOCATIONS - GEOMETRIA INCONSISTENTE
// Coordenadas em formatos diferentes:
coordinates: jsonb("coordinates")           // GeoJSON completo
latitude: decimal("latitude", { precision: 10, scale: 7 })  // Campos separados
üîÑ PROBLEMAS DE MIGRA√á√ÉO
18. VERSIONING AUSENTE
Sem controle de vers√£o de schema
Migra√ß√µes manuais sem automa√ß√£o
Rollback imposs√≠vel
19. DADOS DE TESTE vs PRODU√á√ÉO
Dados mock misturados com reais
IDs hardcoded em v√°rias partes